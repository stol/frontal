/*! frontal 24-10-2017 04:42:19 */
!function(a){a(["jquery"],function(a){function b(b){a(document).on("click","[data-f-ajaxify]:not(form), [type=submit]",d).on("submit mouseenter","[data-f-ajaxify]",d),a.extend(l,b),c()}function c(){a("[data-f-register]").each(function(b,c){f(a(c).attr("data-f-register"),a(c),a(c).attr("data-f-method"))})}function d(b){var c=b.currentTarget,d=a(c);if((!d.is("[type=submit]")||d.closest("form[data-f-ajaxify]")[0])&&("mouseenter"!=b.type||d.attr("data-f-hover"))){var f=d.attr("data-f-ajaxify")||null,i=d.attr("data-f-href")||d.attr("href")||d.attr("action"),j=d.attr("data-f-loading")||null,k=d.attr("data-f-uniq")||null,m=d.attr("data-f-confirm")||null,n=d.attr("data-f-stop")||null,o=d.attr("data-f-toggle")||null,p=null,q=d.attr("data-f-method")||null,r=b.type;if(d.is("[type=submit]")&&(p=d.closest("form[data-f-ajaxify]"),i=i||p.attr("action"),f=p.attr("data-f-ajaxify"),m=m||d.attr("data-f-confirm")),i){if("0"===f)return void b.preventDefault();if(n)return void b.preventDefault();if(m&&!window.confirm(m))return void b.preventDefault();if(d.is("[type=submit]"))return p.append(a('<input type="hidden" class="js-injected"/>').attr({name:d.attr("name")||"",value:d.val()||""})),void g(d[0]);q=d.is("form")?"post":q||"get",g(c,j),d.attr("data-f-ajaxify","0");var s;d.is("form")?(s=d.serializeArray(),s.push({name:"__ajax__",value:1})):s={__ajax__:1};var t={url:i,type:q,data:s,xhrFields:{withCredentials:!0}},u=function(a){if(d.is("form")&&o&&a.success){d.find(".js-loading");d.find("[type=submit]").attr("data-f-stop","").filter(".js-loading").attr("data-f-stop","1")}},v=function(a){e(a,d),u(a)},w=function(a){var b=a.responseJSON;e(b,d),u(b)},x=function(){d.attr("data-f-ajaxify",k?null:"1"),d.is("form")&&d.find(".js-injected").remove(),h(c),"mouseenter"==r&&d.trigger("mouseenter")};l.onBeforeAjax?l.onBeforeAjax(t,v,x):a.ajax(t).done(v).fail(w).always(x),b.preventDefault()}}}function e(b,c){if(c=c||null,"string"==typeof b&&(b=JSON.parse(b)),"undefined"!=typeof b.actions){for(var d=a.isArray(b.actions)?b.actions:[b.actions],e=null,f=null,g=0;g<d.length;g++)if(f=d[g],a.fn[f.method])c&&"this"===f.selector?e=c:f.selector&&(e=a(f.selector)),e=e?e[f.method].apply(e,f.args):a()[f.method].apply(a,f.args);else if(a[f.method])a[f.method].apply(a,[f.args]);else switch(f.method){case"redirect":document.location.href=f.args}a(document).trigger("contentchange")}}function f(b,c,d){return d=d||"get",a.ajax({url:b,type:d,xhrFields:{withCredentials:!0}}).done(function(a){e(a,c)})}function g(b,c){return c&&"spinner"==c?(j||(j=a('<div class="spinner"><div class="spinner-inner"><div class="spinner-icn"></div></div></div>').appendTo("body")),clearInterval(i),j.show(),void(i=setInterval(function(){return j.is(":visible")?(a(".spinner-icn",j).css("top",-40*k+"px"),void(k=(k+1)%12)):void clearInterval(i)},66))):b?void a(b).addClass("js-loading"):void 0}function h(b){b&&a(b).removeClass("js-loading").find(".js-loading").removeClass("js-loading"),j&&j.hide()}var i,j=null,k=1,l={};return{ajaxify:f,listen:b,handleResponse:e}})}("function"==typeof define&&define.amd?define:function(a,b){"undefined"!=typeof module&&module.exports?module.exports=b(require(a[0])):window.frontal=b(window.jQuery)});